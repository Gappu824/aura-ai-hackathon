version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd frontend/aura-ai-ui/ # Keep this explicit cd as it worked for preBuild phase
        # --- START MODIFICATION ---
        # Change 'npm ci' to 'npm install' for more leniency with package-lock.json
        - npm install
        # --- END MODIFICATION ---
    build:
      commands:
        # --- START MODIFICATION ---
        # Remove redundant cd as this phase also starts from appRoot
        # Remove the 'cd frontend/aura-ai-ui/' here if it was present
        - npm run build
        # --- END MODIFICATION ---
  appRoot: frontend/aura-ai-ui # This is correct
  artifacts:
    baseDirectory: .next # This is correct relative to appRoot
    files:
      - '**/*'
  cache:
    # --- START MODIFICATION ---
    # Explicitly define cache paths relative to appRoot
    paths:
      - frontend/aura-ai-ui/node_modules/**/* # Cache node_modules relative to repo root
    # --- END MODIFICATION ---